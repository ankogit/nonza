# План разработки Nonza Video Call Platform

## Обзор

Создание уникальной платформы для аудио-видео звонков с инновационными фичами, а не просто клон Google Meets/Яндекс Телемост. 

**Монорепозиторий структура:**
- `backend/` - Go приложение (REST API, интеграция с LiveKit)
- `frontend/` - Vue.js библиотека-виджет для встраивания на сайты

## Философия проекта

Nonza - это НЕ "классическая звонилка". Это платформа с уникальными фичами:
- Виджет для встраивания на сайты
- Общий документ встречи вместо чата
- Специализированные типы комнат (conference_hall, round_table)
- Обязательный E2EE
- Структура организаций (как Discord сервер)

## Стандарты кодирования

1. Чистый и аккуратный код - Clean Architecture, SOLID
2. Комментарии - кратко и по делу, без тестовых комментариев
3. Качественные решения, а не костыли - пересматривать реализацию при проблемах

## Этап 1: MVP - Временные комнаты (ПРИОРИТЕТ)

### Цель
Создать простую систему временных комнат для быстрого старта.

### Что входит:

1. **Инициализация проекта**
   - Go модуль и базовая структура (cmd, internal, pkg)
   - .env.example с примерами всех переменных
   - Docker compose для разработки

2. **База данных**
   - Таблицы: organizations, rooms, meeting_documents, participants
   - Миграции PostgreSQL

3. **Генерация коротких кодов**
   - Формат: `abc-defg-hij` (3-4-3, только буквы)
   - Проверка уникальности

4. **Базовые сервисы**
   - organizations, rooms, meeting_documents
   - Автоматическая очистка истекших комнат
   - Генерация токенов LiveKit

5. **REST API**
   - POST /api/v1/organizations
   - POST /api/v1/organizations/:orgId/rooms
   - GET /api/v1/rooms/:shortCode
   - POST /api/v1/rooms/:shortCode/token
   - GET/POST /api/v1/rooms/:id/document

6. **Интеграция LiveKit**
   - Self-host через Docker
   - Генерация токенов
   - Создание комнат

7. **Vue.js виджет (базовый)**
   - FSD архитектура
   - Подключение к комнате
   - Видео/аудио треки
   - Разные UI для conference_hall и round_table
   - Компонент документа встречи

8. **E2EE (базовая реализация)**
   - Проверка поддержки браузера
   - Генерация ключей
   - Шифрование медиа-потоков
   - Индикатор E2EE

### Критерии готовности:
- ✅ Можно создать организацию и комнату
- ✅ Получить короткую ссылку
- ✅ Подключиться через виджет
- ✅ Видео/аудио работает
- ✅ E2EE работает
- ✅ Документ встречи создается и редактируется
- ✅ Все тесты проходят
- ✅ Health checks работают

## Технологии

**Backend:**
- Go 1.24+, Gin, GORM, PostgreSQL, Redis
- LiveKit Server SDK (self-host)
- JWT, Rate limiting

**Frontend:**
- Vue 3, TypeScript, FSD архитектура
- LiveKit Client SDK
- Брендовые цвета: #e74c3c, #2980B9, #FFBE53

**Инфраструктура:**
- Docker Compose для разработки
- Self-host LiveKit через Docker
- Redis для координации LiveKit

## Конфигурация

Вся конфигурация через .env файл (без yaml).

## Безопасность

- Обязательный E2EE для всех комнат
- JWT токены с коротким временем жизни
- Rate limiting
- HTTPS/WSS для всех соединений

## Следующие этапы

- Этап 2: Расширенная функциональность (авторизация, комментирование страниц)
- Этап 3: Продвинутые функции (стриминг, OBS)
- Этап 4: Оптимизация и масштабирование
- Этап 5: Музыкальные комнаты (дальний план)
